<!--
@license
Code developed by Dorian Brown in collaboration with Codeself, Inc.
-->

<!-- Polymer -->
<link rel="import" href="../../bower_components/polymer/polymer-element.html">

<!-- Polymerfire Elements -->
<link rel="import" href="../../bower_components/polymerfire/firebase-document.html">

<dom-module id="wrc-active-workouts">
	<template>
		<style></style>

		<!-- Firebase Document Configuration -->
		<firebase-document
			id="firebaseDocument"
			app-name="wrc_software"></firebase-document>

		<h1>Component: wrc-active-workouts</h1>
		<!-- TODO: Load activated workout and show -->
	</template>

	<script>
		"use strict";

		(function() {
			class WrcActiveWorkouts extends Polymer.Element {
				// Element definition
				static get is() {
					return "wrc-active-workouts";
				};

				// Element properties
				static get properties() {
					return {
						user: {
							type: Object,
							notify: true,
							observer: '_userChanged'
						},
						coachUid: {
							type: String,
							notify: true
						}
					};
				};

				/**
				 * Observes for changes on user property
				 */
				_userChanged(user) {
					if (user) {
						this.$.firebaseDocument.getStoredValue(`${this.user.uid}/metadata/path`)
						.then(function(path) {
							this.coachUid = path.split('/', 1)[0];
						});
					}
				}
			}
			window.customElements.define(WrcActiveWorkouts.is, WrcActiveWorkouts);
		}());
	</script>
</dom-module>
